<!DOCTYPE html>
<html lang="en">

<head>

	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">

	<title>Admin</title>

	<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
	<script type="text/javascript" src="https://cdn.datatables.net/1.10.8/js/jquery.dataTables.min.js"></script>
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/jq-3.3.1/dt-1.10.20/datatables.min.css"/>

	<script type="text/javascript" src="https://cdn.datatables.net/v/dt/jq-3.3.1/dt-1.10.20/datatables.min.js"></script>

	<!-- Custom fonts for this template-->
	<link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
	<link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">

	<!-- Custom styles for this template-->
	<link href="css/sb-admin-2.min.css" rel="stylesheet">


	<style type="text/css">
		.inlineBTN{
			display: inline-block;
		}
		.sideRight{
			float:right;
		}
		.sideLeft{
			float:left;
		}

	</style>



</head>

<body id="page-top">

	<!-- Page Wrapper -->
	<div id="wrapper">

		<!-- Sidebar -->
		<ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar">

			<!-- Sidebar - Brand -->
			<br>
			<a class="sidebar-brand d-flex align-items-center justify-content-center" href="admin.html">
        <!-- <div class="sidebar-brand-icon rotate-n-15">
          <i class="fas fa-laugh-wink"></i>
        </div> -->
        <div class="sidebar-brand-text mx-3"> <p id="user_name"></p> </div>
      </a>

      <!-- Divider -->
      <hr class="sidebar-divider my-0">

      <!-- Nav Item - Dashboard -->


      <li class="nav-item active">
       <a class="nav-link" href="admin.html">
        <i class="fas fa-fw fa-tachometer-alt"></i>
        <span>Admin</span></a>
      </li>



      <li class="nav-item">
        <a class="nav-link" href="add_image.html">
         <i class="fas fa-fw fa-tachometer-alt"></i>
         <span>Upload Image</span></a>
       </li>

       <li class="nav-item">
        <a class="nav-link" href="admin_image.html">
          <i class="fas fa-fw fa-tachometer-alt"></i>
          <span>Image Information</span></a>
        </li>


        <li class="nav-item">
        <a class="nav-link" href="crop.html">
          <i class="fas fa-fw fa-tachometer-alt"></i>
          <span>Crop</span></a>
        </li>

        <li class="nav-item">
        <a class="nav-link" href="reference.html">
          <i class="fas fa-fw fa-tachometer-alt"></i>
          <span>Reference</span></a>
        </li>

        <hr class="sidebar-divider my-0">
        <li class="nav-item">
         <a class="nav-link" href="logout.html">
          <i class="fas fa-fw fa-tachometer-alt"></i>
          <span>Logout</span></a>
        </li>


        <!-- Sidebar Toggler (Sidebar) -->
        <div class="text-center d-none d-md-inline">
          <button class="rounded-circle border-0" id="sidebarToggle"></button>
        </div>

      </ul>
      <!-- End of Sidebar -->

      <!-- Content Wrapper -->
      <div id="content-wrapper" class="d-flex flex-column">

       <!-- Main Content -->
       <div id="content">
        <div class="container-fluid">

         <br>
         <h1 class="h3 mb-4 text-gray-800">Admin Page</h1>

         <div class="col-lg-6">
          <div class="input-group">

          </div>
        </div>

        <div class="card shadow mb-4">
          <div class="card-header py-3">
           <h6 class="m-0 font-weight-bold text-primary"> - User - </h6>
           <button class="btn btn-primary btn-icon-split sideRight" id="addUserBtn">
            <span class="text">Add User</span>
          </button>
        </div>
        <div class="card-body">
         <div class="table-responsive">
          <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
           <thead>
            <tr>
             <th>User</th>
             <th>First name</th>
             <th>Last name</th>
             <th>Role</th>
             <th>Segmentation</th>
             <th>Vertify</th>
           </tr>
         </thead>
         <tbody>

         </tbody>
       </table>
     </div>
   </div>
 </div>




 <div class="modal fade" id="addUserModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
   <div class="modal-content">
    <div class="modal-header">
     <h4 class="modal-title" id="exampleModalLabel">Add User</h4>

   </div>
   <div class="modal-body">




     <div class="form-group row">
      <div class="col-sm-6 mb-3 mb-sm-0">
        <label>Firstname</label>
       <input type="text" class="form-control form-control-user" id="inputFirstname" placeholder="First Name">
     </div>
     <div class="col-sm-6">
      <label>Lastname</label>
       <input type="text" class="form-control form-control-user" id="inputLastname" placeholder="Last Name">
     </div>
   </div>

   <div class="form-group row">
    <div class="col-sm-6 mb-3 mb-sm-0">
      <label>Username</label>
     <input type="text" class="form-control form-control-user" id="inputUsername" placeholder="User Name">
   </div>
   <div class="col-sm-6">
    <label>Password</label>
     <input type="password" class="form-control form-control-user" id="inputPassword" placeholder="Password">
   </div>
 </div>


 <div class="form-group row">
  <div class="col-sm-12 mb-12 mb-sm-12">
    <label>Role</label>
    <select id="inputRole" class="form-control">
      <option value="user" selected>user</option>
      <option value="admin">admin</option>
    </select>
  </div>

</div>






<button class="btn btn-primary btn-user btn-block" id="btnConfirm">
  <span class="text">Confirm</span>
</button>
</div>

</div>
</div>
</div>





</div>
<!-- /.container-fluid -->

</div>
<!-- End of Main Content -->

<!-- Footer -->
<footer class="sticky-footer bg-white">
  <div class="container my-auto">
   <div class="copyright text-center my-auto">
    <span>Copyright &copy; Your Website 2019</span>
  </div>
</div>
</footer>
</div>

</div>




<script type="text/javascript">
  window.onload = function() {

    document.getElementById("user_name").innerHTML = "Hi, "+sessionStorage.getItem("username");


    var ref = firebase.database().ref('user');
    ref
    .on('child_added', function(snapshot) { 
      var user = snapshot.val();
      var key1 = snapshot.key;

      var ref2 = firebase.database().ref('user/'+key1+'/annotation/');
      ref2.on("value", function(snapshot) {
       console.log(snapshot.numChildren());

       var ref3 = firebase.database().ref('user/'+key1+'/vertify/');
       ref3.on("value", function(snapshot2) {
        console.log(snapshot2.numChildren());
        addData(user, key1, snapshot.numChildren(), snapshot2.numChildren());
      })

     })


    });

  };

  function addData(user, key1, annotation, vertify) {

   var table = document.getElementById("dataTable");
   var row = table.insertRow(-1);
   var cell1 = row.insertCell(0);
   var cell2 = row.insertCell(1);
   var cell3 = row.insertCell(2);
   var cell4 = row.insertCell(3);
   var cell5 = row.insertCell(4);
   var cell6 = row.insertCell(5);

   cell1.innerHTML = '<a href="admin_user.html?user='+key1+'">'+key1+'</a>';
   cell2.innerHTML = user.firstname;
   cell3.innerHTML = user.lastname;
   cell4.innerHTML = user.role;
   cell5.innerHTML = annotation;
   cell6.innerHTML = vertify;

 }


 $('#addUserBtn').click( function () {

   $('#addUserModal').modal('show');

 } );


 $('#btnConfirm').click( function () {

   var username = document.getElementById("inputUsername").value;
   var password = document.getElementById("inputPassword").value;
   var firstname = document.getElementById("inputFirstname").value;
   var lastname = document.getElementById("inputLastname").value;
   var role = document.getElementById("inputRole").value;



   console.log(username, password, firstname, lastname, role);
   firebase.database().ref('user/'+username).update({
    firstname:firstname,
    lastname:lastname,
    password:password,
    role:role
  }, function(error) {
    if (error) {
    } else {
      window.location.href = "admin.html";
    }
  });

 } );


</script>

<!-- Bootstrap core JavaScript-->
<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

<!-- Core plugin JavaScript-->
<script src="vendor/jquery-easing/jquery.easing.min.js"></script>

<!-- Custom scripts for all pages-->
<script src="js/sb-admin-2.min.js"></script>

<script src="https://www.gstatic.com/firebasejs/7.11.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.11.0/firebase-analytics.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.4.2/firebase.js"></script>
<script>
  var firebaseConfig = {
   apiKey: "AIzaSyBA8_iJYJUTB81W6y41kBbAFUhETKXdn38",
   authDomain: "labeljpn.firebaseapp.com",
   databaseURL: "https://labeljpn.firebaseio.com",
   projectId: "labeljpn",
   storageBucket: "labeljpn.appspot.com",
   messagingSenderId: "478979409533",
   appId: "1:478979409533:web:a286086924054873c6d314",
   measurementId: "G-74RV1SGSWC"
 };
 firebase.initializeApp(firebaseConfig);
</script>

</body>

</html>
